reflo = [-6.348709539607487e-14, -4.232473026404991e-14, -2.116236513202496e-14, -1.5871773849018717e-14,
-1.6929892105619966e-14, -1.058118256601248e-14, -9.069585056582124e-15, -7.935886924509359e-15,
-7.054121710674986e-15, -8.464946052809983e-15, -5.7715541269158975e-15, -5.29059128300624e-15,
-4.88362272277499e-15, -3.0231950188607086e-15, -2.821648684269994e-15, -3.967943462254679e-15,
-2.489690015532348e-15, -2.3513739035583286e-15, -2.2276173823184166e-15, -3.1743547698037436e-15,
-2.0154633459071388e-15, -2.4048142195482905e-15, 0.0, -1.7635304276687464e-15,
-1.6929892105619966e-15, 0.0, 0.0, -1.1336981320727656e-15,
-7.297367286905158e-16, 7.054121710674985e-16, 0.0, 0.0,
-6.412837918795442e-16, 0.0, -6.046390037721416e-16, 1.1756869517791643e-15,
0.0, 1.1138086911592083e-15, 0.0, 1.0581182566012479e-15,
2.06462098849024e-15, 0.0005794956745071824, 9.842960526523235e-16, 0.0,
0.0015100291800084077, 0.010170231329438926, 0.025728741385843894, 0.04005101497165152,
0.04390452127911886, 0.04525686807986621, 0.03530410264550449, 0.021670517548941896,
0.008048864519123124, 0.0010780640392045314, 0.004470323125925969, 0.016688348116340457,
0.03493460910804327, 0.05959215527770473, 0.08244270095710961, 0.10357659617076827,
0.11391336511012921, 0.11627478138119568, 0.12956428457670546, 0.13663776226609609,
0.13497016376638563, 0.13249685947909343, 0.12925392578276643, 0.12817322381349877,
0.13203388059095647, 0.13784600161681598, 0.14240723449087092, 0.13937425900528344,
0.14236086920574512, 0.15049881048630848, 0.16302536651810398, 0.17166029310408853,
0.15680191863869608, 0.14989926543222462, 0.14999356535627262, 0.15783399886553232,
0.17387732650281687, 0.18996005145684927, 0.20460513261203542, 0.2017828459833418,
0.203590444172436, 0.20965401643308929, 0.21978961885490292, 0.23334414164750214,
0.24482639625816902, 0.24450009814539006, 0.241361704385313, 0.2373974635454126,
0.23582082671730284, 0.24335346466686872, 0.25701324342128723, 0.2612141132028289,
0.2660305729207295, 0.2692404779242703, 0.263964354375628, 0.25885651869294757,
0.25754979365637176, 0.254288196603691, 0.2503362377317122, 0.2568193720912553,
0.2574604980989164, 0.2485319153927413, 0.24205644600344794, 0.23863075415041338,
0.23819906143846187, 0.23908594757055368, 0.24173305614768417, 0.24770712558590272,
0.24877543972694863, 0.24892880078238666, 0.2590256898954135, 0.27166808320495917,
0.28251928763456524, 0.29162484188457044, 0.2990287539426958, 0.3008865750588349,
0.28577157939536907, 0.2773551436197429, 0.268485802151751, 0.26277533660806096,
0.2633127557034817, 0.2663000601279467, 0.2702453624196831, 0.2753066947598586,
0.2822525773726178, 0.27968003222135107, 0.27684017791426246, 0.2737971896326203,
0.26963063318403047, 0.2643656630796935, 0.25965299728293023, 0.2585011820584089,
0.24854591958584712, 0.2430030832516569, 0.23904201480796408, 0.23985015545585645,
0.24728657601452025, 0.2569315745253772, 0.266520726664246, 0.2746487420772013,
0.28134585117926253, 0.2866414561548989, 0.2920067929281561, 0.28967430030982805,
0.2880077439312323, 0.288510829916702, 0.28919779478701874, 0.29278856854550295,
0.2997378763748437, 0.3127219617756912, 0.3078585682435972, 0.30763813418697433,
0.3123729588390938, 0.32012974068543115, 0.3302985368071382, 0.33922797405322,
0.3400150482124273, 0.33663341679143066, 0.3339007121337234, 0.3298189861614539,
0.3244127665348869, 0.32058884855731573, 0.32118808369256424, 0.32630111972700526,
0.33284953446230253, 0.32926421804558403, 0.3327651361236813, 0.3426218018642772,
0.3423855654841696, 0.3306579511745207, 0.31923898910700166, 0.3118223610448929,
0.3065518776552234, 0.3071122760309198, 0.31401481781361384, 0.32169601368595346,
0.32988432780701954, 0.3372745855961669, 0.34548506656580164, 0.35246577682985175,
0.35396308945843974, 0.3577273271576752, 0.363231053913255, 0.3638967738452223,
0.3588223472785071, 0.35554231180656304, 0.35943155749311084, 0.3666088366234249,
0.36259249062210475, 0.3487658723827629, 0.3359619736344609, 0.3223877605974673,
0.3106225302007395, 0.30296375784327684, 0.3014745016770177, 0.3046726127337049,
0.30988668050762663, 0.317728188762448, 0.3289511297424724, 0.34373311785458177,
0.36278682227654396, 0.3827612368184497, 0.4030778282669414, 0.41120559536292073,
0.41055220793579156, 0.4122571066869349, 0.40992614632401275, 0.4048223000408057,
0.400321623164694, 0.39588340931483806, 0.39313314088683077, 0.3969234373130931,
0.4060619592316241, 0.41377185912011777, 0.41714203908292624, 0.4150723889033669,
0.4100328514069579, 0.4052900191597187, 0.4002587071424406, 0.3989137429103623,
0.4031942481568127, 0.4077209702428449, 0.4099745452392779, 0.41540722380025175,
0.42153563465409927, 0.42505338976043805, 0.4259831673784225, 0.427143466428484,
0.4283866422609185, 0.43082670612005863, 0.4255250622127837, 0.4208461818605876,
0.41818437287732685, 0.4170953583386116, 0.4144990630503587, 0.41186678541389793,
0.4115996854298485, 0.4056961954038659, 0.40098900289946593, 0.39496848014113567,
0.38668681168778507, 0.3834726184828498, 0.3764527211018305, 0.36938496789459807,
0.3630576189188345, 0.3568556984778469]
refhi = [31.917204450284782, 16.932239511551998, 11.994517392552043, 9.584217728451947,
8.10628782192911, 7.0975967411252965, 6.39645666944237, 5.901264162321405,
5.495463556286324, 5.152237281011368, 4.879784949500827, 4.673054226704583,
4.482512483622468, 4.303983206813759, 4.135063903023782, 3.9739527023115193,
3.819271704133845, 3.669949208068331, 3.525139134834113, 3.4104134778162924,
3.3709627094430035, 3.322888194788645, 3.2673147703246475, 3.2051797997772273,
3.1372706686763916, 3.064253626316756, 2.986696218393756, 2.905084912646316,
2.8198721542188956, 2.7410314167421053, 2.672760581622756, 2.599502482784571,
2.542903555664134, 2.5201546408800395, 2.4909291751605025, 2.46347544713647,
2.440203948947183, 2.4095602883242973, 2.372111554685783, 2.3283681285078117,
2.35110533491961, 2.3666665009529186, 2.3725651057534756, 2.369459960314425,
2.35795131465174, 2.3439198252346114, 2.3442313576669997, 2.3521391002164744,
2.3559707670338503, 2.351344833824406, 2.3387588064720712, 2.3186719211774,
2.3021433105646447, 2.2929166351323835, 2.2837575529773844, 2.2720715966501337,
2.253451179372895, 2.228254980160326, 2.206621825538713, 2.2265381069035604,
2.237031476008932, 2.238557880222222, 2.2315443178716206, 2.223419992092579,
2.2212293720727287, 2.236721058631896, 2.244141469485805, 2.243846690327335,
2.2361721642005024, 2.2214341659753796, 2.2003537100086477, 2.1771781207007326,
2.153273120385483, 2.125323965857102, 2.098700759718762, 2.0992573478955996,
2.0977981919901754, 2.097206235543601, 2.096807455783442, 2.0954367698413843,
2.092328696672403, 2.0822702818778316, 2.0655127426248576, 2.0422953333584237,
2.0128460494907716, 1.996796743078305, 2.00646971273678, 2.01707230245634,
2.026865130062295, 2.0295172353930786, 2.0283109492751628, 2.0237732130151014,
2.016683298268531, 2.0057288593312004, 1.9936220145826855, 1.9827997217856215,
1.9705706636183393, 1.957415091422549, 1.9454072743348574, 1.9368459388294168,
1.9305387241548866, 1.9216070890633343, 1.9073061677044048, 1.8922214422747685,
1.8795088464835308, 1.8716751757925083, 1.8686801059269904, 1.8646126604756152,
1.8558735781925564, 1.8402669581694788, 1.8201274172345854, 1.8176355685089265,
1.8283580183197359, 1.8327988423536985, 1.8311219091093416, 1.8252298709241315,
1.818882200265471, 1.81559754774534, 1.8133471950068, 1.8219414394127593,
1.8277065349956902, 1.8333163356276947, 1.8388164509301608, 1.84633128829015,
1.855487774207935, 1.8620165938925903, 1.8650352280505633, 1.8683265471733517,
1.8674292766828489, 1.8601234587815316, 1.8509401695484171, 1.844702839971218,
1.8379210455386354, 1.8247614914050734, 1.8053659055638835, 1.8184014787186613,
1.8323424752884971, 1.8401158276717893, 1.8493748344785492, 1.8605959624349366,
1.8685650199728956, 1.8753642360706488, 1.8801785487437959, 1.885042242340755,
1.887752219133277, 1.8847612067297628, 1.880587087952027, 1.8760236768533078,
1.8655828807096093, 1.8489724782986583, 1.826315044579408, 1.7977299288539939,
1.7816463104590459, 1.8132756344201248, 1.8398738291418253, 1.8622333441064587,
1.8794098928940448, 1.892111677383889, 1.8990372292634377, 1.8991958175519492,
1.8972573023274302, 1.8989509741151542, 1.8977512335978843, 1.8915587466396786,
1.8875871110251927, 1.8822899594724387, 1.874052974783995, 1.8762388542760413,
1.8878371577582833, 1.897124829774482, 1.9036777374888811, 1.9046862594297183,
1.9008415274302985, 1.8986693010300657, 1.914332161615297, 1.9254872667173353,
1.933168874921557, 1.9357657226281264, 1.934925270313838, 1.9300725926121831,
1.9210576909678778, 1.907779822534061, 1.892625679521541, 1.8788674050783838,
1.866455958953833, 1.8529374204933733, 1.8593698049491787, 1.8637283539383553,
1.8616566994484653, 1.8545377325823087, 1.8442520218562986, 1.8348318206786332,
1.8249100871165258, 1.8246047978590818, 1.827126394852936, 1.8230377030675533,
1.8141675230797218, 1.8038493756323082, 1.7928085112374317, 1.7826935353028226,
1.7777073281145646, 1.786728804294096, 1.789577722515789, 1.7863448556907853,
1.781290916162904, 1.7773773528569843, 1.7715449378918218, 1.7647467432771569,
1.7553864886932242, 1.7445895103890794, 1.733718121237644, 1.7198809834856756,
1.7030749600161919, 1.6965150954625188, 1.6858632017765836, 1.693183827590814,
1.6986959961756778, 1.7005568919312795, 1.7093668548476197, 1.7292512835035259,
1.7485139381505965, 1.7695467080386964, 1.791645469388392, 1.811622337813538,
1.8275942143810395, 1.836771128131683, 1.8392204050291943, 1.8352940265818136,
1.8299966809921944, 1.8295471375152572, 1.8334033178873554, 1.8369247326917209,
1.8363162409416394, 1.8376515267951465, 1.8395185332753015, 1.8374792223593692,
1.8330884737642625, 1.8265021865684263, 1.8222991897515293, 1.8239147996140013,
1.824795151074386, 1.8216708845003273, 1.8275609800115848, 1.83711672477262,
1.8422019068491204, 1.84177423141554, 1.8357445090850546, 1.8254441682932698,
1.8118902523940805, 1.7995974466201832]

using PointPatternStatistics
using Random
window = (x=(0,1), y=(0,1))
r0 = 0:0.001:0.25
n = 2500
Random.seed!(1)
xys = [[(rand(), rand()) for _ in 1:30] for _ in 1:n]
a = [pcf(xy, window, r0)[2:end] for xy in xys]

lo, hi = globalenvelope(a)
@test refhi == hi
@test refhi == hi
